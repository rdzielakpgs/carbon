import { useState } from "react";
import { Meta, Story, Preview } from "@storybook/addon-docs/blocks";
import { action } from "@storybook/addon-actions";

import ShowEditPod, { BaseShowEditPod } from "./show-edit-pod.component";
import Content from "../content";
import Textbox from "../../__experimental__/components/textbox";
import Fieldset from "../../__experimental__/components/fieldset";

<Meta
  title="ShowEditPod/Test"
  parameters={{
    info: { disable: true },
    chromatic: {
      disable: true,
    },
    knobs: {
      disable: true,
    },
  }}
  argTypes={{
    buttonAlign: {
      options: ["left", "right"],
      control: {
        type: "select",
      },
    },
    variant: {
      options: ["primary", "secondary", "tertiary", "tile", "transparent"],
      control: {
        type: "select",
      },
    },
  }}
/>

export const ShowEditPodStory = (args) => {
  const [isEditing, setIsEditing] = useState(false);
  const [state, setState] = useState({
    edit_first_name: "Alan",
    edit_second_name: "Smith",
    edit_telephone: "000 000 0000",
  });
  const fieldProps = [
    {
      key: "edit_first_name",
      label: "First Name",
    },
    {
      key: "edit_second_name",
      label: "Second Name",
    },
    {
      key: "edit_telephone",
      label: "Telephone",
    },
  ];
  const onEdit = () => {
    setIsEditing(true);
    action("edit")();
  };
  const onCancel = () => {
    setIsEditing(false);
    action("cancel")();
  };
  const onDelete = () => {
    setIsEditing(false);
    action("delete")();
  };
  const onSave = () => {
    setIsEditing(false);
    action("onSave")();
  };
  const setField = (fieldName) => (e) => {
    setState({ ...state, [fieldName]: e.target.value });
  };
  return (
    <ShowEditPod
      editing={isEditing}
      onDelete={onDelete}
      onCancel={onCancel}
      onEdit={onEdit}
      editFields={
        <Fieldset>
          {fieldProps.map(({ key, label }) => (
            <Textbox
              label={label}
              key={key}
              onChange={setField(key)}
              value={state[key]}
              labelInline
              labelAlign="right"
            />
          ))}
        </Fieldset>
      }
      onSave={onSave}
      {...args}
    >
      {fieldProps.map(({ key, label }) => (
        <Content key={key} title={label}>
          {state[key]}
        </Content>
      ))}
    </ShowEditPod>
  );
};

# ShowEditPod

### Default

<Preview>
  <Story
    name="default"
    args={{
      border: BaseShowEditPod.defaultProps.border,
      buttonAlign: BaseShowEditPod.defaultProps.buttonAlign,
      cancel: BaseShowEditPod.defaultProps.cancel,
      cancelText: "Cancel",
      deleteText: "Delete",
      saveText: "Save",
      saving: BaseShowEditPod.defaultProps.saving,
      title: "Person",
      transitionName: BaseShowEditPod.defaultProps.transitionName,
      variant: BaseShowEditPod.defaultProps.variant,
    }}
  >
    {ShowEditPodStory.bind({})}
  </Story>
</Preview>
